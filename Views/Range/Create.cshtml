@model VCashApp.Models.DTOs.Range.RangeUpsertDto
@{
    ViewData["Title"] = "Crear Rango";
    Layout = "_Layout";

    var clients = (IEnumerable<SelectListItem>)ViewBag.AvailableClients ?? Enumerable.Empty<SelectListItem>();
}

<div class="form-container">
    <div class="card-body">
        <form id="range-create-form"
              asp-action="Save"
              asp-controller="Range"
              method="post"
              data-validate-url="@Url.Action("ValidateUnique","Range")">
            @Html.AntiForgeryToken()
            <input type="hidden" name="IsEdit" value="false" />
            
            <div class="card">
                <div class="card-header"><h5 class="mb-0"><i class="ri-information-fill"></i> Información</h5></div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-12 col-lg-4">
                            <div class="form-floating has-validation">
                                <input asp-for="CodRange" class="form-control" placeholder="Código" />
                                <label asp-for="CodRange">Código</label>
                                <span asp-validation-for="CodRange" class="text-danger"></span>
                            </div>
                        </div>

                        <div class="col-12 col-lg-5">
                            <div class="form-floating">
                                <select asp-for="ClientId" class="form-select" asp-items="clients">
                                    <option value="">-- Seleccione cliente --</option>
                                </select>
                                <label asp-for="ClientId">Cliente</label>
                                <span asp-validation-for="ClientId" class="text-danger"></span>
                            </div>
                        </div>

                        <div class="col-12 col-lg-3">
                            <div class="form-floating">
                                <select class="form-select" id="rangeStatusSelect">
                                    <option value="true" selected>Activo</option>
                                    <option value="false">Inactivo</option>
                                </select>
                                <label>Estado</label>
                            </div>
                            <input type="hidden" asp-for="RangeStatus" />
                        </div>

                        <div class="col-12">
                            <div class="form-floating">
                                <textarea asp-for="RangeInformation" class="form-control" placeholder="Descripción" style="height: 80px;"></textarea>
                                <label asp-for="RangeInformation">Descripción (opcional)</label>
                                <span asp-validation-for="RangeInformation" class="text-danger"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-header">
                    <h5 class="mb-0"><i class="ri-timer-fill"></i> Horarios por día (hasta 3 rangos)</h5>
                </div>
                <div class="card-body">
                    @Html.Partial("~/Views/Range/_RangeScheduleTablePartial.cshtml", Model)
                </div>
            </div>
            

            <div class="submit-container-spacer"></div>
            <div class="submit-container form-group col-12 mt-4 fixed">
                <button type="submit" class="btn btn-primary">Guardar</button>
                <a asp-action="Index" class="btn btn-danger">Cancelar</a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    @{ await Html.RenderPartialAsync("_ValidationScriptsPartial"); }

    <script src="~/js/form-control/range-form-handler.js"></script>
}