@model VCashApp.Models.ViewModels.CentroEfectivo.CefContainerProcessingViewModel
@{
    var prefix = ViewData.TemplateInfo.HtmlFieldPrefix;
}

<div class="container-editor border rounded p-3" data-prefix="@prefix">
    <input type="hidden" asp-for="Id" />
    <input type="hidden" asp-for="CefTransactionId" />

    <div class="row g-3">
        <div class="col-12 col-lg-3">
            <div class="form-floating has-validation">
                <select asp-for="ContainerType" class="form-select js-container-type"
                        asp-items="Html.GetEnumSelectList<VCashApp.Enums.CefContainerTypeEnum>()" required aria-required="true">
                </select>
                <label class="required">Tipo de Contenedor</label>
                <div class="invalid-feedback">⚠ Requerido</div>
                <div class="valid-feedback">✓ Correcto</div>
            </div>
        </div>

        <div class="col-12 col-lg-3">
            <div class="form-floating has-validation">
                <input asp-for="ContainerCode" class="form-control" placeholder="Código" required aria-required="true" />
                <label class="required">Código del Contenedor</label>
                <div class="invalid-feedback">⚠ Requerido</div>
                <div class="valid-feedback">✓ Correcto</div>
            </div>
        </div>

        <!-- Solo para sobres: selección de bolsa padre -->
        <div class="col-12 col-lg-3 js-parent-bag-block" style="display:none;">
            <div class="form-floating has-validation">
                <select asp-for="ParentContainerId" class="form-select">
                    <option value="">-- Seleccione bolsa --</option>
                    @* JS llenará opciones *@
                </select>
                <label>Bolsa asociada</label>
                <div class="invalid-feedback">⚠ Requerido</div>
                <div class="valid-feedback">✓ Correcto</div>
            </div>
        </div>

        <div class="col-12 col-lg-3">
            <div class="form-floating">
                <input asp-for="DeclaredValue" type="number" step="1" class="form-control" placeholder="Valor declarado" />
                <label>Valor declarado (opcional)</label>
            </div>
        </div>
    </div>

    <div class="sec-bolsa mt-3">
        <div class="card">
            <div class="card-header"><h6 class="mb-0">🧳 Bolsa — Detalle (Billetes/Monedas)</h6></div>
            <div class="card-body">
                <table class="table table-sm align-middle js-details-table" data-detail-scope="bolsa">
                    <thead>
                        <tr>
                            <th>Tipo</th>
                            <th>Denominación</th>
                            <th>Cantidad</th>
                            <th>Fajos</th>
                            <th>Picos</th>
                            <th>Valor Unit.</th>
                            <th>Monto</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        @* Si quieres precargar, recorre Model.ValueDetails (Bill/Coin) *@
                    </tbody>
                </table>
                <button type="button" class="btn btn-outline-primary btn-sm js-add-detail" data-detail-scope="bolsa">
                    + Agregar detalle
                </button>
            </div>
        </div>
    </div>

    <div class="sec-sobre mt-3" style="display:none;">
        <div class="mb-2">
            <div class="form-check form-check-inline">
                <input class="form-check-input js-sobre-mode" type="radio" name="@($"{prefix}.SobreMode")" value="Cash" checked />
                <label class="form-check-label">Efectivo</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input js-sobre-mode" type="radio" name="@($"{prefix}.SobreMode")" value="Document" />
                <label class="form-check-label">Documentos/Vouchers</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input js-sobre-mode" type="radio" name="@($"{prefix}.SobreMode")" value="Check" />
                <label class="form-check-label">Cheques</label>
            </div>
        </div>

        <!-- Sobre: EFECTIVO -->
        <div class="sec-sobre-cash">
            <div class="card">
                <div class="card-header"><h6 class="mb-0">💵 Sobre — Efectivo (Billetes/Monedas)</h6></div>
                <div class="card-body">
                    <table class="table table-sm align-middle js-details-table" data-detail-scope="sobre-cash">
                        <thead>
                            <tr>
                                <th>Tipo</th>
                                <th>Denominación</th>
                                <th>Cantidad</th>
                                <th>Fajos</th>
                                <th>Picos</th>
                                <th>Valor Unit.</th>
                                <th>Monto</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                    <button type="button" class="btn btn-outline-primary btn-sm js-add-detail" data-detail-scope="sobre-cash">
                        + Agregar detalle
                    </button>
                </div>
            </div>
        </div>

        <!-- Sobre: DOCUMENTOS/VOUCHERS -->
        <div class="sec-sobre-docs" style="display:none;">
            <div class="card">
                <div class="card-header"><h6 class="mb-0">📄 Sobre — Documentos/Vouchers</h6></div>
                <div class="card-body">
                    <table class="table table-sm align-middle js-details-table" data-detail-scope="sobre-docs">
                        <thead>
                            <tr>
                                <th>Tipo</th>
                                <th>Denominación</th>
                                <th>Cantidad</th>
                                <th>Fajos</th>
                                <th>Picos</th>
                                <th>Valor Unit.</th>
                                <th>Monto</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                    <button type="button" class="btn btn-outline-primary btn-sm js-add-detail" data-detail-scope="sobre-docs">
                        + Agregar documento
                    </button>
                </div>
            </div>
        </div>

        <!-- Sobre: CHEQUES -->
        <div class="sec-sobre-cheque" style="display:none;">
            <div class="card">
                <div class="card-header"><h6 class="mb-0">🏦 Sobre — Cheques</h6></div>
                <div class="card-body">
                    <table class="table table-sm align-middle js-cheques-table">
                        <thead>
                            <tr>
                                <th>Banco</th>
                                <th>Número</th>
                                <th>Fecha</th>
                                <th>Valor</th>
                                <th>Cantidad</th>
                                <th>Monto</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                    <button type="button" class="btn btn-outline-primary btn-sm js-add-cheque">
                        + Agregar cheque
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Observaciones (común) -->
    <div class="mt-3">
        <div class="form-floating">
            <textarea asp-for="Observations" class="form-control" style="height:80px" placeholder="Observaciones"></textarea>
            <label>Observaciones</label>
        </div>
    </div>
</div>
